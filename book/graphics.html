<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Graphics | Circular Visualization in R</title>
  <meta name="description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Graphics | Circular Visualization in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/jokergoo/circlize-book/book" />
  <meta property="og:image" content="https://bookdown.org/jokergoo/circlize-book/bookimages/circlize_cover.jpg" />
  <meta property="og:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="github-repo" content="jokergoo/circlize_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Graphics | Circular Visualization in R" />
  
  <meta name="twitter:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="twitter:image" content="https://bookdown.org/jokergoo/circlize-book/bookimages/circlize_cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="circular-layout.html"/>
<link rel="next" href="legends.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Circular Visualization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I General Functionality</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#principle-of-design"><i class="fa fa-check"></i><b>1.1</b> Principle of design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-qiuck-glance"><i class="fa fa-check"></i><b>1.2</b> A quick glance</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="circular-layout.html"><a href="circular-layout.html"><i class="fa fa-check"></i><b>2</b> Circular layout</a>
<ul>
<li class="chapter" data-level="2.1" data-path="circular-layout.html"><a href="circular-layout.html#coordinate-transformation"><i class="fa fa-check"></i><b>2.1</b> Coordinate transformation</a></li>
<li class="chapter" data-level="2.2" data-path="circular-layout.html"><a href="circular-layout.html#rules-for-making-the-circular-plot"><i class="fa fa-check"></i><b>2.2</b> Rules for making the circular plot</a></li>
<li class="chapter" data-level="2.3" data-path="circular-layout.html"><a href="circular-layout.html#sectors-and-tracks"><i class="fa fa-check"></i><b>2.3</b> Sectors and tracks</a></li>
<li class="chapter" data-level="2.4" data-path="circular-layout.html"><a href="circular-layout.html#graphic-parameters"><i class="fa fa-check"></i><b>2.4</b> Graphic parameters</a></li>
<li class="chapter" data-level="2.5" data-path="circular-layout.html"><a href="circular-layout.html#create-plotting-regions"><i class="fa fa-check"></i><b>2.5</b> Create plotting regions</a></li>
<li class="chapter" data-level="2.6" data-path="circular-layout.html"><a href="circular-layout.html#update-plotting-regions"><i class="fa fa-check"></i><b>2.6</b> Update plotting regions</a></li>
<li class="chapter" data-level="2.7" data-path="circular-layout.html"><a href="circular-layout.html#panel-fun"><i class="fa fa-check"></i><b>2.7</b> <code>panel.fun</code> argument</a></li>
<li class="chapter" data-level="2.8" data-path="circular-layout.html"><a href="circular-layout.html#other-utilities"><i class="fa fa-check"></i><b>2.8</b> Other utilities</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="circular-layout.html"><a href="circular-layout.html#circlize_and_reverse_circlize"><i class="fa fa-check"></i><b>2.8.1</b> <code>circlize()</code> and <code>reverse.circlize()</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="circular-layout.html"><a href="circular-layout.html#convert-functions"><i class="fa fa-check"></i><b>2.8.2</b> Absolute units</a></li>
<li class="chapter" data-level="2.8.3" data-path="circular-layout.html"><a href="circular-layout.html#circos-info-and-circos-clear"><i class="fa fa-check"></i><b>2.8.3</b> <code>circos.info()</code> and <code>circos.clear()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="circular-layout.html"><a href="circular-layout.html#set-gaps-between-tracks"><i class="fa fa-check"></i><b>2.9</b> Set gaps between tracks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>3</b> Graphics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="graphics.html"><a href="graphics.html#setting-colors"><i class="fa fa-check"></i><b>3.1</b> Setting colors</a></li>
<li class="chapter" data-level="3.2" data-path="graphics.html"><a href="graphics.html#points"><i class="fa fa-check"></i><b>3.2</b> Points</a></li>
<li class="chapter" data-level="3.3" data-path="graphics.html"><a href="graphics.html#lines"><i class="fa fa-check"></i><b>3.3</b> Lines</a></li>
<li class="chapter" data-level="3.4" data-path="graphics.html"><a href="graphics.html#segments"><i class="fa fa-check"></i><b>3.4</b> Segments</a></li>
<li class="chapter" data-level="3.5" data-path="graphics.html"><a href="graphics.html#text"><i class="fa fa-check"></i><b>3.5</b> Text</a></li>
<li class="chapter" data-level="3.6" data-path="graphics.html"><a href="graphics.html#rectangles"><i class="fa fa-check"></i><b>3.6</b> Rectangles and polygons</a></li>
<li class="chapter" data-level="3.7" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>3.7</b> Axes</a></li>
<li class="chapter" data-level="3.8" data-path="graphics.html"><a href="graphics.html#barplots-boxplots-and-violin-plots"><i class="fa fa-check"></i><b>3.8</b> Barplots, boxplots and violin plots</a></li>
<li class="chapter" data-level="3.9" data-path="graphics.html"><a href="graphics.html#circular-arrows"><i class="fa fa-check"></i><b>3.9</b> Circular arrows</a></li>
<li class="chapter" data-level="3.10" data-path="graphics.html"><a href="graphics.html#raster-image"><i class="fa fa-check"></i><b>3.10</b> Raster image</a></li>
<li class="chapter" data-level="3.11" data-path="graphics.html"><a href="graphics.html#links"><i class="fa fa-check"></i><b>3.11</b> Links</a></li>
<li class="chapter" data-level="3.12" data-path="graphics.html"><a href="graphics.html#highlight-sectors-and-tracks"><i class="fa fa-check"></i><b>3.12</b> Highlight sectors and tracks</a></li>
<li class="chapter" data-level="3.13" data-path="graphics.html"><a href="graphics.html#work-with-base-graphic-system"><i class="fa fa-check"></i><b>3.13</b> Work together with the base graphic system</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>4</b> Legends</a></li>
<li class="chapter" data-level="5" data-path="high-level-plots.html"><a href="high-level-plots.html"><i class="fa fa-check"></i><b>5</b> Implement high-level circular plots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-level-plots.html"><a href="high-level-plots.html#circular-barplot"><i class="fa fa-check"></i><b>5.1</b> Circular barplots</a></li>
<li class="chapter" data-level="5.2" data-path="high-level-plots.html"><a href="high-level-plots.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Histograms</a></li>
<li class="chapter" data-level="5.3" data-path="high-level-plots.html"><a href="high-level-plots.html#phylogenetic-trees"><i class="fa fa-check"></i><b>5.3</b> Phylogenetic trees</a></li>
<li class="chapter" data-level="5.4" data-path="high-level-plots.html"><a href="high-level-plots.html#heatmaps"><i class="fa fa-check"></i><b>5.4</b> Manually create heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="circos-heatmap.html"><a href="circos-heatmap.html"><i class="fa fa-check"></i><b>6</b> The <code>circos.heatmap()</code> function</a>
<ul>
<li class="chapter" data-level="6.1" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circos-heatmap-input-data"><i class="fa fa-check"></i><b>6.1</b> Input data</a></li>
<li class="chapter" data-level="6.2" data-path="circos-heatmap.html"><a href="circos-heatmap.html#circular-layout-1"><i class="fa fa-check"></i><b>6.2</b> Circular layout</a></li>
<li class="chapter" data-level="6.3" data-path="circos-heatmap.html"><a href="circos-heatmap.html#dendrograms-and-row-names"><i class="fa fa-check"></i><b>6.3</b> Dendrograms and row names</a></li>
<li class="chapter" data-level="6.4" data-path="circos-heatmap.html"><a href="circos-heatmap.html#clustering"><i class="fa fa-check"></i><b>6.4</b> Clustering</a></li>
<li class="chapter" data-level="6.5" data-path="circos-heatmap.html"><a href="circos-heatmap.html#callback-on-dendrograms"><i class="fa fa-check"></i><b>6.5</b> Callback on dendrograms</a></li>
<li class="chapter" data-level="6.6" data-path="circos-heatmap.html"><a href="circos-heatmap.html#multiple-heatmap-tracks"><i class="fa fa-check"></i><b>6.6</b> Multiple heatmap tracks</a></li>
<li class="chapter" data-level="6.7" data-path="circos-heatmap.html"><a href="circos-heatmap.html#with-other-tracks"><i class="fa fa-check"></i><b>6.7</b> With other tracks</a></li>
<li class="chapter" data-level="6.8" data-path="circos-heatmap.html"><a href="circos-heatmap.html#add-annotations"><i class="fa fa-check"></i><b>6.8</b> Add annotations</a></li>
<li class="chapter" data-level="6.9" data-path="circos-heatmap.html"><a href="circos-heatmap.html#a-complex-example-of-circular-heatmaps"><i class="fa fa-check"></i><b>6.9</b> A complex example of circular heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-layout.html"><a href="advanced-layout.html"><i class="fa fa-check"></i><b>7</b> Advanced layout</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-layout.html"><a href="advanced-layout.html#zooming-of-sectors"><i class="fa fa-check"></i><b>7.1</b> Zooming of sectors</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-layout.html"><a href="advanced-layout.html#part-circle"><i class="fa fa-check"></i><b>7.2</b> Visualize part of the circle</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-layout.html"><a href="advanced-layout.html#combine-circular-plots"><i class="fa fa-check"></i><b>7.3</b> Combine multiple circular plots</a></li>
<li class="chapter" data-level="7.4" data-path="advanced-layout.html"><a href="advanced-layout.html#arrange-multiple-plots"><i class="fa fa-check"></i><b>7.4</b> Arrange multiple plots</a></li>
</ul></li>
<li class="part"><span><b>II Applications in Genomics</b></span></li>
<li class="chapter" data-level="8" data-path="genomic-introduction.html"><a href="genomic-introduction.html"><i class="fa fa-check"></i><b>8</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1" data-path="genomic-introduction.html"><a href="genomic-introduction.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html"><i class="fa fa-check"></i><b>9</b> Initialize with genomic data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-cytoband"><i class="fa fa-check"></i><b>9.1</b> Initialize with cytoband data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#basic-usage"><i class="fa fa-check"></i><b>9.1.1</b> Basic usage</a></li>
<li class="chapter" data-level="9.1.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#pre-defined-tracks"><i class="fa fa-check"></i><b>9.1.2</b> Pre-defined tracks</a></li>
<li class="chapter" data-level="9.1.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#other-general-settings"><i class="fa fa-check"></i><b>9.1.3</b> Other general settings</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#customize-chromosome-track"><i class="fa fa-check"></i><b>9.2</b> Customize chromosome track</a></li>
<li class="chapter" data-level="9.3" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#initialize-with-general-genomic-category"><i class="fa fa-check"></i><b>9.3</b> Initialize with general genomic category</a></li>
<li class="chapter" data-level="9.4" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#zooming-chromosomes"><i class="fa fa-check"></i><b>9.4</b> Zooming chromosomes</a></li>
<li class="chapter" data-level="9.5" data-path="initialize-genomic-plot.html"><a href="initialize-genomic-plot.html#concatenating-two-genomes"><i class="fa fa-check"></i><b>9.5</b> Concatenating two genomes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html"><i class="fa fa-check"></i><b>10</b> Create plotting regions for genomic data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-points"><i class="fa fa-check"></i><b>10.1</b> Points</a></li>
<li class="chapter" data-level="10.2" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-lines"><i class="fa fa-check"></i><b>10.2</b> Lines</a></li>
<li class="chapter" data-level="10.3" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-text"><i class="fa fa-check"></i><b>10.3</b> Text</a></li>
<li class="chapter" data-level="10.4" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-rectangles"><i class="fa fa-check"></i><b>10.4</b> Rectangles</a></li>
<li class="chapter" data-level="10.5" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#genomic-links"><i class="fa fa-check"></i><b>10.5</b> Links</a></li>
<li class="chapter" data-level="10.6" data-path="genomic-plotting-region.html"><a href="genomic-plotting-region.html#mixed-use-of-general-circlize-functions"><i class="fa fa-check"></i><b>10.6</b> Mixed use of general circlize functions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modes-of-input.html"><a href="modes-of-input.html"><i class="fa fa-check"></i><b>11</b> modes for <code>circos.genomicTrack()</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="modes-of-input.html"><a href="modes-of-input.html#normal-mode"><i class="fa fa-check"></i><b>11.1</b> Normal mode</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame"><i class="fa fa-check"></i><b>11.1.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.1.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames"><i class="fa fa-check"></i><b>11.1.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="modes-of-input.html"><a href="modes-of-input.html#stack-mode"><i class="fa fa-check"></i><b>11.2</b> Stack mode</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-data-frame-1"><i class="fa fa-check"></i><b>11.2.1</b> Input is a data frame</a></li>
<li class="chapter" data-level="11.2.2" data-path="modes-of-input.html"><a href="modes-of-input.html#input-is-a-list-of-data-frames-1"><i class="fa fa-check"></i><b>11.2.2</b> Input is a list of data frames</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="modes-of-input.html"><a href="modes-of-input.html#applications"><i class="fa fa-check"></i><b>11.3</b> Applications</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-points"><i class="fa fa-check"></i><b>11.3.1</b> Points</a></li>
<li class="chapter" data-level="11.3.2" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-lines"><i class="fa fa-check"></i><b>11.3.2</b> Lines</a></li>
<li class="chapter" data-level="11.3.3" data-path="modes-of-input.html"><a href="modes-of-input.html#modes-rectangles"><i class="fa fa-check"></i><b>11.3.3</b> Rectangles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html"><i class="fa fa-check"></i><b>12</b> High-level genomic functions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#ideograms"><i class="fa fa-check"></i><b>12.1</b> Ideograms</a></li>
<li class="chapter" data-level="12.2" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-heatmap"><i class="fa fa-check"></i><b>12.2</b> Heatmaps</a></li>
<li class="chapter" data-level="12.3" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#labels"><i class="fa fa-check"></i><b>12.3</b> Labels</a></li>
<li class="chapter" data-level="12.4" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-axes"><i class="fa fa-check"></i><b>12.4</b> Genomic axes</a></li>
<li class="chapter" data-level="12.5" data-path="high-level-genomic-functions.html"><a href="high-level-genomic-functions.html#genomic-density-and-rainfall-plot"><i class="fa fa-check"></i><b>12.5</b> Genomic density and Rainfall plot</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nested-zooming.html"><a href="nested-zooming.html"><i class="fa fa-check"></i><b>13</b> Nested zooming</a>
<ul>
<li class="chapter" data-level="13.1" data-path="nested-zooming.html"><a href="nested-zooming.html#basic-idea"><i class="fa fa-check"></i><b>13.1</b> Basic idea</a></li>
<li class="chapter" data-level="13.2" data-path="nested-zooming.html"><a href="nested-zooming.html#visualization-of-dmrs-from-tagmentation-based-wgbs"><i class="fa fa-check"></i><b>13.2</b> Visualization of DMRs from tagmentation-based WGBS</a></li>
</ul></li>
<li class="part"><span><b>III Visualize Relations</b></span></li>
<li class="chapter" data-level="14" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html"><i class="fa fa-check"></i><b>14</b> The <code>chordDiagram()</code> function</a>
<ul>
<li class="chapter" data-level="14.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#basic-usage-of-making-chord-diagram"><i class="fa fa-check"></i><b>14.1</b> Basic usage of making Chord diagram</a></li>
<li class="chapter" data-level="14.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#adjust-by-circos.par"><i class="fa fa-check"></i><b>14.2</b> Adjust by <code>circos.par()</code></a></li>
<li class="chapter" data-level="14.3" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-colors"><i class="fa fa-check"></i><b>14.3</b> Colors</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#set-grid-colors"><i class="fa fa-check"></i><b>14.3.1</b> Set grid colors</a></li>
<li class="chapter" data-level="14.3.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-color"><i class="fa fa-check"></i><b>14.3.2</b> Set link colors</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#chord-diagram-link-border"><i class="fa fa-check"></i><b>14.4</b> Link border</a></li>
<li class="chapter" data-level="14.5" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#highlight-links"><i class="fa fa-check"></i><b>14.5</b> Highlight links</a></li>
<li class="chapter" data-level="14.6" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#orders-of-links"><i class="fa fa-check"></i><b>14.6</b> Orders of links</a></li>
<li class="chapter" data-level="14.7" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#z-index-of-adding-links"><i class="fa fa-check"></i><b>14.7</b> z-index of adding links</a></li>
<li class="chapter" data-level="14.8" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#self-links"><i class="fa fa-check"></i><b>14.8</b> Self-links</a></li>
<li class="chapter" data-level="14.9" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#symmetric-matrix"><i class="fa fa-check"></i><b>14.9</b> Symmetric matrix</a></li>
<li class="chapter" data-level="14.10" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#directional-relations"><i class="fa fa-check"></i><b>14.10</b> Directional relations</a></li>
<li class="chapter" data-level="14.11" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#scaling"><i class="fa fa-check"></i><b>14.11</b> Scaling</a></li>
<li class="chapter" data-level="14.12" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#reduce"><i class="fa fa-check"></i><b>14.12</b> Reduce</a></li>
<li class="chapter" data-level="14.13" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#input-as-a-data-frame"><i class="fa fa-check"></i><b>14.13</b> Input as a data frame</a>
<ul>
<li class="chapter" data-level="14.13.1" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#multiple-links-between-two-sectors"><i class="fa fa-check"></i><b>14.13.1</b> Multiple links between two sectors</a></li>
<li class="chapter" data-level="14.13.2" data-path="the-chorddiagram-function.html"><a href="the-chorddiagram-function.html#unequal-width-of-the-link-ends"><i class="fa fa-check"></i><b>14.13.2</b> Unequal width of the link ends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html"><i class="fa fa-check"></i><b>15</b> Advanced usage of <code>chordDiagram()</code></a>
<ul>
<li class="chapter" data-level="15.1" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#organization-of-tracks"><i class="fa fa-check"></i><b>15.1</b> Organization of tracks</a></li>
<li class="chapter" data-level="15.2" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-labels"><i class="fa fa-check"></i><b>15.2</b> Customize sector labels</a></li>
<li class="chapter" data-level="15.3" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#customize-sector-axes"><i class="fa fa-check"></i><b>15.3</b> Customize sector axes</a></li>
<li class="chapter" data-level="15.4" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#put-horizontally-or-vertically-symmetric"><i class="fa fa-check"></i><b>15.4</b> Put horizontally or vertically symmetric</a></li>
<li class="chapter" data-level="15.5" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#compare-two-chord-diagrams"><i class="fa fa-check"></i><b>15.5</b> Compare two Chord diagrams</a></li>
<li class="chapter" data-level="15.6" data-path="advanced-usage-of-chorddiagram.html"><a href="advanced-usage-of-chorddiagram.html#multiple-group-chord-diagram"><i class="fa fa-check"></i><b>15.6</b> Multiple-group Chord diagram</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-complex-example-of-chord-diagram.html"><a href="a-complex-example-of-chord-diagram.html"><i class="fa fa-check"></i><b>16</b> A complex example of Chord diagram</a></li>
<li class="part"><span><b>IV Others</b></span></li>
<li class="chapter" data-level="17" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html"><i class="fa fa-check"></i><b>17</b> Make fun of the package</a>
<ul>
<li class="chapter" data-level="17.1" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-clock"><i class="fa fa-check"></i><b>17.1</b> A clock</a></li>
<li class="chapter" data-level="17.2" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#a-dartboard"><i class="fa fa-check"></i><b>17.2</b> A dartboard</a></li>
<li class="chapter" data-level="17.3" data-path="make-fun-of-the-package.html"><a href="make-fun-of-the-package.html#ba-gua-and-tai-ji"><i class="fa fa-check"></i><b>17.3</b> Ba-Gua and Tai-Ji</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Circular Visualization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Graphics</h1>
<p>In this chapter, we will introduce low-level functions that add graphics to
the circle. Usages of most of these functions are similar as normal graphic
functions (e.g. <code>points()</code>, <code>lines()</code>). Combination use of these functions can
generate very complex circular plots.</p>
<p>All low-level functions accept <code>sector.index</code> and <code>track.index</code> arguments
which indicate which cell the graphics are added in. By default the graphics
are added in the “current” sector and “current” track, so it is recommended to
use them directly inside <code>panel.fun</code> function. However, they can also be used
in other places with explicitly specifying sector and track index. Following
code shows an example of using <code>ciros.points()</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="graphics.html#cb55-1"></a><span class="kw">circos.track</span>(..., <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb55-2"><a href="graphics.html#cb55-2"></a>    <span class="kw">circos.points</span>(x, y)</span>
<span id="cb55-3"><a href="graphics.html#cb55-3"></a>})</span>
<span id="cb55-4"><a href="graphics.html#cb55-4"></a><span class="kw">circos.points</span>(x, y, sector.index, track.index)</span></code></pre></div>
<p>In this chapter, we will also discuss how to customize links and how to highlight
regions in the circle.</p>
<div id="setting-colors" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Setting colors</h2>
<p>Color is a major aesthetic element to map to the data points. In <strong>circlize</strong> there are
two functions that provides customization of colors.</p>
<p><code>colorRamp2()</code> provides an exact way for mapping continuous values. users specify a vector
of break values and a vector of colors, all the other colors are linearly interpolated between
the correspoding break values. In following example, we generate a color mapping which is symmetric
to zero.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="graphics.html#cb56-1"></a>col_fun =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb56-2"><a href="graphics.html#cb56-2"></a><span class="kw">col_fun</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="dv">1</span>)) <span class="co"># all the values smaller than -2 are all mapped to blue</span></span></code></pre></div>
<pre><code>## [1] &quot;#0000FFFF&quot; &quot;#0000FFFF&quot; &quot;#0000FFFF&quot; &quot;#0000FFFF&quot; &quot;#B38BFFFF&quot; &quot;#FFFFFFFF&quot;
## [7] &quot;#FF9E81FF&quot;</code></pre>
<p><code>rand_color()</code> implements the algorithem of <a href="https://github.com/davidmerfield/randomColor">randomColor.js</a>.
See the following example:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="graphics.html#cb58-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb58-2"><a href="graphics.html#cb58-2"></a><span class="kw">plot</span>(<span class="ot">NULL</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>)</span>
<span id="cb58-3"><a href="graphics.html#cb58-3"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-4"><a href="graphics.html#cb58-4"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">luminosity =</span> <span class="st">&quot;random&quot;</span>))</span>
<span id="cb58-5"><a href="graphics.html#cb58-5"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-6"><a href="graphics.html#cb58-6"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">luminosity =</span> <span class="st">&quot;bright&quot;</span>))</span>
<span id="cb58-7"><a href="graphics.html#cb58-7"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-8"><a href="graphics.html#cb58-8"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">luminosity =</span> <span class="st">&quot;light&quot;</span>))</span>
<span id="cb58-9"><a href="graphics.html#cb58-9"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-10"><a href="graphics.html#cb58-10"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">luminosity =</span> <span class="st">&quot;dark&quot;</span>))</span>
<span id="cb58-11"><a href="graphics.html#cb58-11"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">5</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-12"><a href="graphics.html#cb58-12"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">hue =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">luminosity =</span> <span class="st">&quot;bright&quot;</span>))</span>
<span id="cb58-13"><a href="graphics.html#cb58-13"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">6</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-14"><a href="graphics.html#cb58-14"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">hue =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">luminosity =</span> <span class="st">&quot;bright&quot;</span>))</span>
<span id="cb58-15"><a href="graphics.html#cb58-15"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">7</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-16"><a href="graphics.html#cb58-16"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">hue =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">luminosity =</span> <span class="st">&quot;bright&quot;</span>))</span>
<span id="cb58-17"><a href="graphics.html#cb58-17"></a><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">8</span>, <span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, </span>
<span id="cb58-18"><a href="graphics.html#cb58-18"></a>    <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">10</span>, <span class="dt">hue =</span> <span class="st">&quot;monochrome&quot;</span>, <span class="dt">luminosity =</span> <span class="st">&quot;bright&quot;</span>))</span></code></pre></div>
<p><img src="03-graphics_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Actually there is another function <code>col2value()</code> which can convert back to the values
highly approximate to the original values from a vector of colors.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="graphics.html#cb59-1"></a>col_fun =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb59-2"><a href="graphics.html#cb59-2"></a>value =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb59-3"><a href="graphics.html#cb59-3"></a>value</span></code></pre></div>
<pre><code>##  [1] -2.0 -1.8 -1.6 -1.4 -1.2 -1.0 -0.8 -0.6 -0.4 -0.2  0.0  0.2  0.4  0.6  0.8
## [16]  1.0  1.2  1.4  1.6  1.8  2.0</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="graphics.html#cb61-1"></a>col =<span class="st"> </span><span class="kw">col_fun</span>(value)</span>
<span id="cb61-2"><a href="graphics.html#cb61-2"></a><span class="kw">col2value</span>(col, <span class="dt">col_fun =</span> col_fun)</span></code></pre></div>
<pre><code>##  [1] -2.000000e+00 -1.795620e+00 -1.595206e+00 -1.391406e+00 -1.189672e+00
##  [6] -9.870220e-01 -7.853407e-01 -5.861849e-01 -3.901391e-01 -1.985154e-01
## [11] -7.401487e-17  1.761338e-01  3.592285e-01  5.454043e-01  7.429882e-01
## [16]  9.423823e-01  1.150753e+00  1.359655e+00  1.575352e+00  1.785834e+00
## [21]  2.000000e+00</code></pre>
</div>
<div id="points" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Points</h2>
<p>Adding points by <code>circos.points()</code> is similar as <code>points()</code> function. Possible
usages are:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="graphics.html#cb63-1"></a><span class="kw">circos.points</span>(x, y)</span>
<span id="cb63-2"><a href="graphics.html#cb63-2"></a><span class="kw">circos.points</span>(x, y, sector.index, track.index)</span>
<span id="cb63-3"><a href="graphics.html#cb63-3"></a><span class="kw">circos.points</span>(x, y, pch, col, cex)</span></code></pre></div>
<p>There is a companion function <code>circos.trackPoints()</code> which adds points to all
sectors in a same track simultaneously. The input of <code>circos.trackPoints()</code>
must contain a vector of categorical factors, a vector of x values and a
vector of y values. X values and y values are split by the categorical
variable and corresponding subset of x and y values are internally sent to
<code>circos.points()</code>. <code>circos.trackPoints()</code> adds points to the “current” track
by default which is the most recently created track. Other tracks can also be
selected by explictly setting <code>track.index</code> argument.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="graphics.html#cb64-1"></a><span class="kw">circos.track</span>(...)</span>
<span id="cb64-2"><a href="graphics.html#cb64-2"></a><span class="kw">circos.trackPoints</span>(sectors, x, y)</span></code></pre></div>
<p><code>circos.trackPoints()</code> is simply implemented by <code>circos.points()</code> with a <code>for</code>
loop. However, it is more recommended to directly use <code>circos.points()</code> and
<code>panel.fun</code> which provides great more flexibility. Actually following code is
identical to above code.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="graphics.html#cb65-1"></a><span class="kw">circos.track</span>(sectors, x, y, <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb65-2"><a href="graphics.html#cb65-2"></a>    <span class="kw">circos.points</span>(x, y)</span>
<span id="cb65-3"><a href="graphics.html#cb65-3"></a>})</span></code></pre></div>
<p>Other low-level functions also have their companion <code>circos.track*()</code>
function. The usage is same as <code>circos.trackPoints()</code> and they will not be
further discussed in following sections.</p>
</div>
<div id="lines" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Lines</h2>
<p>Adding lines by <code>circos.lines()</code> is similar as <code>lines()</code> function. One
additional feature is that the areas under or above the lines can be filled by
specifing <code>area</code> argument to <code>TRUE</code>. Position of the baseline can be set to a
pre-defined string of <code>bottom</code> or <code>top</code>, or a numeric value which is the
position on y-axis. When <code>area</code> is set to <code>TRUE</code>, <code>col</code> controls the filled
color and <code>border</code> controls the color for the borders.</p>
<p><code>baseline</code> argument is also workable when <code>lty</code> is set to <code>"h"</code>. Note when <code>lty</code>
is set to <code>"h"</code>, graphic parameters such as <code>col</code> can be set as a vector with
same length as <code>x</code>. Figure <a href="graphics.html#fig:circlize-lines">3.1</a> illustrates supported <code>lty</code>
settings and <code>area</code>/<code>baseline</code> settings.</p>
<div class="figure" style="text-align: center"><span id="fig:circlize-lines"></span>
<img src="03-graphics_files/figure-html/circlize-lines-1.png" alt="Line styles and areas supported in `circos.lines()`" width="576" />
<p class="caption">
Figure 3.1: Line styles and areas supported in <code>circos.lines()</code>
</p>
</div>
<p>Straight lines are transformed to curves when mapping to the circular layout
(Figure <a href="graphics.html#fig:circlize-linecurve">3.2</a>). Normally, curves are approximated by a
series of segments of straight lines. With more and shorter segments, there is
better approximation, but with larger size if the figures are generated into
e.g. PDF files, especially for huge dataset. Default length of segments in
<strong>circlize</strong> is a balance between the quality and size of the figure. You can
set the length of the unit segment by <code>unit.circle.segments</code> option in
<code>circos.par()</code>. The length of the segment is calculated as the length of the
unit circle (2<span class="math inline">\(\pi\)</span>) divided by <code>unit.circle.segments</code>. In some scenarios,
actually you don’t need to segment the lines such as radical lines, then you can
set <code>straight</code> argument to <code>TRUE</code> to get rid of unnecessary segmentations.</p>
<div class="figure" style="text-align: center"><span id="fig:circlize-linecurve"></span>
<img src="03-graphics_files/figure-html/circlize-linecurve-1.png" alt="Transformation of straight lines into curves in the circle." width="768" />
<p class="caption">
Figure 3.2: Transformation of straight lines into curves in the circle.
</p>
</div>
<p>Possible usages for <code>circos.lines()</code> are:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="graphics.html#cb66-1"></a><span class="kw">circos.lines</span>(x, y)</span>
<span id="cb66-2"><a href="graphics.html#cb66-2"></a><span class="kw">circos.lines</span>(x, y, sector.index, track.index)</span>
<span id="cb66-3"><a href="graphics.html#cb66-3"></a><span class="kw">circos.lines</span>(x, y, col, lwd, lty, type, straight)</span>
<span id="cb66-4"><a href="graphics.html#cb66-4"></a><span class="kw">circos.lines</span>(x, y, col, area, baseline, border)</span></code></pre></div>
</div>
<div id="segments" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Segments</h2>
<p>Line segments can be added by <code>circos.segments()</code> function. The usage is similar
as <code>segments()</code>. Radical segments can be added by setting <code>straight</code> to <code>TRUE</code>.
An example is in Figure <a href="graphics.html#fig:circlize-segments">3.3</a>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="graphics.html#cb67-1"></a><span class="kw">circos.segments</span>(x0, y0, x1, y1)</span>
<span id="cb67-2"><a href="graphics.html#cb67-2"></a><span class="kw">circos.segments</span>(x0, y0, x1, y1, straight)</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="graphics.html#cb68-1"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb68-2"><a href="graphics.html#cb68-2"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">track.height =</span> <span class="fl">0.3</span>, <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb68-3"><a href="graphics.html#cb68-3"></a>    x =<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="dt">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb68-4"><a href="graphics.html#cb68-4"></a>    y =<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="dt">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb68-5"><a href="graphics.html#cb68-5"></a></span>
<span id="cb68-6"><a href="graphics.html#cb68-6"></a>    <span class="kw">circos.segments</span>(x, <span class="fl">0.1</span>, x, <span class="fl">0.9</span>)</span>
<span id="cb68-7"><a href="graphics.html#cb68-7"></a>    <span class="kw">circos.segments</span>(<span class="fl">0.1</span>, y, <span class="fl">0.9</span>, y)</span>
<span id="cb68-8"><a href="graphics.html#cb68-8"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-segments"></span>
<img src="03-graphics_files/figure-html/circlize-segments-1.png" alt="Draw segments." width="672" />
<p class="caption">
Figure 3.3: Draw segments.
</p>
</div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="graphics.html#cb69-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
</div>
<div id="text" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Text</h2>
<p>Adding text by <code>circos.text()</code> is similar as <code>text()</code> function. Text is added on
the plot for human reading, thus, when putting the text on the circle, the
facing of text is very important. <code>circos.text()</code> supports seven facing options
which are <code>inside</code>, <code>outside</code>, <code>clockwise</code>, <code>reverse.clockwise</code>, <code>downward</code>,
<code>bending.inside</code> and <code>bending.outside</code>. Please note for <code>bending.inside</code> and
<code>bending.outside</code>, currently, single line text is only supported. If you want to
put bended text into two lines, you need to split text into two lines and add
each line by <code>circos.text()</code> separately. The different facings are illustrated
in Figure <a href="graphics.html#fig:circlize-text">3.4</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:circlize-text"></span>
<img src="03-graphics_files/figure-html/circlize-text-1.png" alt="Text facings." width="672" />
<p class="caption">
Figure 3.4: Text facings.
</p>
</div>
<p>Possible usages for <code>circos.text()</code> are:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="graphics.html#cb70-1"></a><span class="kw">circos.text</span>(x, y, labels)</span>
<span id="cb70-2"><a href="graphics.html#cb70-2"></a><span class="kw">circos.text</span>(x, y, labels, sector.index, track.index)</span>
<span id="cb70-3"><a href="graphics.html#cb70-3"></a><span class="kw">circos.text</span>(x, y, labels, facing, niceFacing, adj, cex, col, font)</span></code></pre></div>
<p>If, e.g., <code>facing</code> is set to <code>inside</code>, text which is on the bottom half of the
circle is still facing to the top and hard to read. To make text more easy to
read and not to hurt readers’ neck too much, <code>circos.text()</code> provides
<code>niceFacing</code> option which automatically adjust text facing according to their
positions in the circle. <code>niceFacing</code> only works for <code>facing</code> value of
<code>inside</code>, <code>outside</code>, <code>clockwise</code>, <code>reverse.clockwise</code>, <code>bending.inside</code> and
<code>bending.outside</code>.</p>
<p>When <code>niceFacing</code> is on, <code>adj</code> is also adjusted according to the corresponding
facings. Figure <a href="graphics.html#fig:circlize-text-easy">3.5</a> illustrates text positions under
different settings of <code>adj</code> and <code>facing</code>. The red dots are the positions of the texts.</p>
<div class="figure" style="text-align: center"><span id="fig:circlize-text-easy"></span>
<img src="03-graphics_files/figure-html/circlize-text-easy-1.png" alt="Human easy text facing." width="768" />
<p class="caption">
Figure 3.5: Human easy text facing.
</p>
</div>
<p><code>adj</code> is internally passed to <code>text()</code>, thus, it actually adjusts text
positions either horizontally or vertically (in the canvas coordinate). If the
direction of the offset is circular, the offset value can be set as degrees
that the position of the text is adjusted by wrapping the offset by
<code>degree()</code>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="graphics.html#cb71-1"></a><span class="kw">circos.text</span>(x, y, labels, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">degree</span>(<span class="dv">5</span>)), <span class="dt">facing =</span> <span class="st">&quot;clockwise&quot;</span>)</span></code></pre></div>
<p>As <code>circos.text()</code> is applied in the data coordiante, offset can be directly
added to <code>x</code> or/and <code>y</code> as a value measured in the data coordinate. An absolute
offset can be set by using e.g. <code>mm_x()</code> (in x direction) and <code>mm_y()</code> (in y
direction).</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="graphics.html#cb72-1"></a><span class="kw">circos.text</span>(x <span class="op">+</span><span class="st"> </span><span class="kw">mm_x</span>(<span class="dv">2</span>), y <span class="op">+</span><span class="st"> </span><span class="kw">mm_y</span>(<span class="dv">2</span>), labels)</span></code></pre></div>
</div>
<div id="rectangles" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Rectangles and polygons</h2>
<p>Theoretically, circular rectangles and polygons are all polygons. If you imagine
the plotting region in a cell as Cartesian coordinate, then <code>circos.rect()</code>
draws rectangles. In the circle, the up and bottom edge become two arcs. Note this
function can be vectorized.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="graphics.html#cb73-1"></a><span class="kw">circos.rect</span>(xleft, ybottom, xright, ytop)</span>
<span id="cb73-2"><a href="graphics.html#cb73-2"></a><span class="kw">circos.rect</span>(xleft, ybottom, xright, ytop, sector.index, track.index)</span>
<span id="cb73-3"><a href="graphics.html#cb73-3"></a><span class="kw">circos.rect</span>(xleft, ybottom, xright, ytop, col, border, lty, lwd)</span></code></pre></div>
<p><code>circos.polygon()</code> draws a polygon through a series of points in a cell.
Please note the first data point must overlap to the last data point.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="graphics.html#cb74-1"></a><span class="kw">circos.polygon</span>(x, y)</span>
<span id="cb74-2"><a href="graphics.html#cb74-2"></a><span class="kw">circos.polygon</span>(x, y, col, border, lty, lwd)</span></code></pre></div>
<p>In Figure <a href="graphics.html#fig:circlize-errorline">3.6</a>, the area of standard deviation of the
smoothed line is drawn by <code>circos.polygon()</code>. Source code can be found in the
<strong>Examples</strong> section of the <code>circos.polygon()</code> help page.</p>
<div class="figure" style="text-align: center"><span id="fig:circlize-errorline"></span>
<img src="03-graphics_files/figure-html/circlize-errorline-1.png" alt="Area of standard deviation of the smoothed line." width="384" />
<p class="caption">
Figure 3.6: Area of standard deviation of the smoothed line.
</p>
</div>
</div>
<div id="axes" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Axes</h2>
<p>Mostly, we only draw x-axes on the circle. <code>circos.axis()</code> or <code>circos.xaxis()</code>
privides options to customize x-axes which are on the circular direction. It
supports basic functionalities as <code>axis()</code> such as defining the breaks and
corresponding labels. Besides that, the function also supports to put x-axes to
a specified position on y direction, to position the x-axes facing the center of
the circle or outside of the circle, and to customize the axes ticks. The <code>at</code>
and <code>labels</code> arguments can be set to a long vector that the parts which exceed
the maximal value in the corresponding cell are removed automatically. The
facing of labels text can be optimized by <code>labels.niceFacing</code> (by default it is
<code>TRUE</code>).</p>
<p>Figure <a href="graphics.html#fig:circlize-xaxis">3.7</a> illustrates different settings of x-axes. The
explanations are as follows:</p>
<ul>
<li>a: Major ticks are calculated automatically, other settings are defaults.</li>
<li>b: Ticks are pointing to inside of the circle, facing of tick labels is set to
<code>outside</code>.</li>
<li>c: Position of x-axis is <code>bottom</code> in the cell.</li>
<li>d: Ticks are pointing to the inside of the circle, facing of tick labels is
set to <code>reverse.clockwise</code>.</li>
<li>e: manually set major ticks and also set the position of x-axis.</li>
<li>f: replace numeric labels to characters, with no minor ticks.</li>
<li>g: No ticks for both major and minor, facing of tick labels is set to
<code>reverse.clockwise</code>.</li>
<li>h: Number of minor ticks between two major ticks is set to 2. Length of ticks
is longer. Facing of tick labels is set to <code>clockwise</code>.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:circlize-xaxis"></span>
<img src="03-graphics_files/figure-html/circlize-xaxis-1.png" alt="X-axes" width="672" />
<p class="caption">
Figure 3.7: X-axes
</p>
</div>
<p>As you may notice in the above figure, when the first and last axis labels
exceed data ranges on x-axis in the corresponding cell, their positions are
automatically adjusted to be shifted inwards in the cell.</p>
<p>Possible usage of <code>circos.axis()</code> is as follows. Note <code>h</code> can be <code>bottom</code>, <code>top</code>
or a numeric value, and <code>major.tick.length</code> can be set with <code>mm_y()</code>/<code>cm_y()</code>/<code>inch_y()</code>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="graphics.html#cb75-1"></a><span class="kw">circos.axis</span>(h)</span>
<span id="cb75-2"><a href="graphics.html#cb75-2"></a><span class="kw">circos.axis</span>(h, sector.index, track.index)</span>
<span id="cb75-3"><a href="graphics.html#cb75-3"></a><span class="kw">circos.axis</span>(h, major.at, labels, major.tick, direction)</span>
<span id="cb75-4"><a href="graphics.html#cb75-4"></a><span class="kw">circos.axis</span>(h, major.at, labels, major.tick, labels.font, labels.cex,</span>
<span id="cb75-5"><a href="graphics.html#cb75-5"></a>            labels.facing, labels.niceFacing)</span>
<span id="cb75-6"><a href="graphics.html#cb75-6"></a><span class="kw">circos.axis</span>(h, major.at, labels, major.tick, minor.ticks,</span>
<span id="cb75-7"><a href="graphics.html#cb75-7"></a>            major.tick.length, lwd)</span></code></pre></div>
<p>Y-axis is also supported by <code>circos.yaxis()</code>. The usage is similar as
<code>circos.axis()</code> One thing that needs to be note is users need to manually adjust
<code>gap.degree</code>/<code>gap.after</code> in <code>circos.par()</code> to make sure there are enough spaces for y-axes.
(Figure <a href="graphics.html#fig:circlize-yaxis">3.8</a>)</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="graphics.html#cb76-1"></a><span class="kw">circos.yaxis</span>(side) <span class="co"># break values are automatically calculated</span></span>
<span id="cb76-2"><a href="graphics.html#cb76-2"></a><span class="kw">circos.yaxis</span>(side, at, labels, sector.index, track.index)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-yaxis"></span>
<img src="03-graphics_files/figure-html/circlize-yaxis-1.png" alt="Y-axes" width="672" />
<p class="caption">
Figure 3.8: Y-axes
</p>
</div>
</div>
<div id="barplots-boxplots-and-violin-plots" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Barplots, boxplots and violin plots</h2>
<p><code>circos.barplot()</code>, <code>circos.boxplot()</code> and <code>circos.violin()</code> are introduced
together because the values on x-axes are the integer indices of bars, boxes
or violins for which xlim should be properly set in <code>circos.initialize()</code>.</p>
<p>For circular barplots, users can either specify a vector which generates a
“normal” barplot, or a matrix which generates a stacked barplot (Figure <a href="graphics.html#fig:circlize-barplot">3.9</a>).</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="graphics.html#cb77-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb77-2"><a href="graphics.html#cb77-2"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb77-3"><a href="graphics.html#cb77-3"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb77-4"><a href="graphics.html#cb77-4"></a>    value =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</span>
<span id="cb77-5"><a href="graphics.html#cb77-5"></a>    <span class="kw">circos.barplot</span>(value, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb77-6"><a href="graphics.html#cb77-6"></a>})</span>
<span id="cb77-7"><a href="graphics.html#cb77-7"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb77-8"><a href="graphics.html#cb77-8"></a>    value =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb77-9"><a href="graphics.html#cb77-9"></a>    <span class="kw">circos.barplot</span>(value, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">col =</span> <span class="kw">ifelse</span>(value <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb77-10"><a href="graphics.html#cb77-10"></a>})</span>
<span id="cb77-11"><a href="graphics.html#cb77-11"></a><span class="kw">circos.clear</span>()</span>
<span id="cb77-12"><a href="graphics.html#cb77-12"></a></span>
<span id="cb77-13"><a href="graphics.html#cb77-13"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb77-14"><a href="graphics.html#cb77-14"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb77-15"><a href="graphics.html#cb77-15"></a>    value =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">10</span><span class="op">*</span><span class="dv">4</span>), <span class="dt">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb77-16"><a href="graphics.html#cb77-16"></a>    <span class="kw">circos.barplot</span>(value, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb77-17"><a href="graphics.html#cb77-17"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-barplot"></span>
<img src="03-graphics_files/figure-html/circlize-barplot-1.png" alt="Circular barplots." width="768" />
<p class="caption">
Figure 3.9: Circular barplots.
</p>
</div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="graphics.html#cb78-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
<p>For circular boxplots, the boxes can be drawn one-by-one by providing a vector
for each box, or drawn in batch with a list/matrix as input (Figure <a href="graphics.html#fig:circlize-boxplot">3.10</a>).</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="graphics.html#cb79-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb79-2"><a href="graphics.html#cb79-2"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb79-3"><a href="graphics.html#cb79-3"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb79-4"><a href="graphics.html#cb79-4"></a>    <span class="cf">for</span>(pos <span class="cf">in</span> <span class="kw">seq</span>(<span class="fl">0.5</span>, <span class="fl">9.5</span>, <span class="dt">by =</span> <span class="dv">1</span>)) {</span>
<span id="cb79-5"><a href="graphics.html#cb79-5"></a>        value =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</span>
<span id="cb79-6"><a href="graphics.html#cb79-6"></a>        <span class="kw">circos.boxplot</span>(value, pos)</span>
<span id="cb79-7"><a href="graphics.html#cb79-7"></a>    }</span>
<span id="cb79-8"><a href="graphics.html#cb79-8"></a>})</span>
<span id="cb79-9"><a href="graphics.html#cb79-9"></a><span class="kw">circos.clear</span>()</span>
<span id="cb79-10"><a href="graphics.html#cb79-10"></a></span>
<span id="cb79-11"><a href="graphics.html#cb79-11"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb79-12"><a href="graphics.html#cb79-12"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb79-13"><a href="graphics.html#cb79-13"></a>    value =<span class="st"> </span><span class="kw">replicate</span>(<span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb79-14"><a href="graphics.html#cb79-14"></a>    <span class="kw">circos.boxplot</span>(value, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb79-15"><a href="graphics.html#cb79-15"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-boxplot"></span>
<img src="03-graphics_files/figure-html/circlize-boxplot-1.png" alt="Circular boxplots." width="768" />
<p class="caption">
Figure 3.10: Circular boxplots.
</p>
</div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="graphics.html#cb80-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
<p>For circular violin plots, the violins can be drawn one-by-one by providing a vector for each violin, or drawn in batch with a list/matrix as input (Figure <a href="graphics.html#fig:circlize-violinplot">3.11</a>).</p>
<p>Please note, to make it comparable between violins, <code>max_density</code> argument should be set.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="graphics.html#cb81-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb81-2"><a href="graphics.html#cb81-2"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb81-3"><a href="graphics.html#cb81-3"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb81-4"><a href="graphics.html#cb81-4"></a>    <span class="cf">for</span>(pos <span class="cf">in</span> <span class="kw">seq</span>(<span class="fl">0.5</span>, <span class="fl">9.5</span>, <span class="dt">by =</span> <span class="dv">1</span>)) {</span>
<span id="cb81-5"><a href="graphics.html#cb81-5"></a>        value =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>)</span>
<span id="cb81-6"><a href="graphics.html#cb81-6"></a>        <span class="kw">circos.violin</span>(value, pos)</span>
<span id="cb81-7"><a href="graphics.html#cb81-7"></a>    }</span>
<span id="cb81-8"><a href="graphics.html#cb81-8"></a>})</span>
<span id="cb81-9"><a href="graphics.html#cb81-9"></a><span class="kw">circos.clear</span>()</span>
<span id="cb81-10"><a href="graphics.html#cb81-10"></a></span>
<span id="cb81-11"><a href="graphics.html#cb81-11"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb81-12"><a href="graphics.html#cb81-12"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb81-13"><a href="graphics.html#cb81-13"></a>    value =<span class="st"> </span><span class="kw">replicate</span>(<span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb81-14"><a href="graphics.html#cb81-14"></a>    <span class="kw">circos.violin</span>(value, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb81-15"><a href="graphics.html#cb81-15"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-violinplot"></span>
<img src="03-graphics_files/figure-html/circlize-violinplot-1.png" alt="Circular violin plots." width="768" />
<p class="caption">
Figure 3.11: Circular violin plots.
</p>
</div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="graphics.html#cb82-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
</div>
<div id="circular-arrows" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> Circular arrows</h2>
<p><code>circos.arrow()</code> draws circular arrows parallel to the circle. Since the arrow
is always parallel to the circle, on x-direction, the start and end position
of the arrow need to be defined while on the y-direction, only the position of
the center of arrow needs to be defined. Also <code>width</code> controls the width of
the arrow and the length is defined by <code>x2 - x1</code>. <code>arrow.head.width</code> and
<code>arrow.head.length</code> control the size of the arrow head, and values are
measured in the data coordinate in corresponding cell. <code>tail</code> controls the
shape of the arrow tail. Note for <code>width</code>, <code>arrow.head.width</code> and
<code>arrow.head.length</code>, the value can be set by e.g. <code>mm_x()</code>, <code>mm_y()</code> with
absolute units. If users want to draw the arrows in the reversed direction,
set <code>arrow.position</code> argument to <code>start</code>. See Figure
<a href="graphics.html#fig:circular-arrow">3.12</a>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="graphics.html#cb83-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb83-2"><a href="graphics.html#cb83-2"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb83-3"><a href="graphics.html#cb83-3"></a>col =<span class="st"> </span><span class="kw">rand_color</span>(<span class="dv">4</span>)</span>
<span id="cb83-4"><a href="graphics.html#cb83-4"></a>tail =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;point&quot;</span>, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb83-5"><a href="graphics.html#cb83-5"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb83-6"><a href="graphics.html#cb83-6"></a>    <span class="kw">circos.arrow</span>(<span class="dt">x1 =</span> <span class="dv">0</span>, <span class="dt">x2 =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.4</span>, </span>
<span id="cb83-7"><a href="graphics.html#cb83-7"></a>        <span class="dt">arrow.head.width =</span> <span class="fl">0.6</span>, <span class="dt">arrow.head.length =</span> <span class="kw">cm_x</span>(<span class="dv">1</span>), </span>
<span id="cb83-8"><a href="graphics.html#cb83-8"></a>        <span class="dt">col =</span> col[CELL_META<span class="op">$</span>sector.numeric.index], </span>
<span id="cb83-9"><a href="graphics.html#cb83-9"></a>        <span class="dt">tail =</span> tail[CELL_META<span class="op">$</span>sector.numeric.index])</span>
<span id="cb83-10"><a href="graphics.html#cb83-10"></a>}, <span class="dt">bg.border =</span> <span class="ot">NA</span>, <span class="dt">track.height =</span> <span class="fl">0.4</span>)</span>
<span id="cb83-11"><a href="graphics.html#cb83-11"></a><span class="kw">circos.clear</span>()</span>
<span id="cb83-12"><a href="graphics.html#cb83-12"></a></span>
<span id="cb83-13"><a href="graphics.html#cb83-13"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb83-14"><a href="graphics.html#cb83-14"></a>tail =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;normal&quot;</span>, <span class="st">&quot;point&quot;</span>, <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb83-15"><a href="graphics.html#cb83-15"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb83-16"><a href="graphics.html#cb83-16"></a>    <span class="kw">circos.arrow</span>(<span class="dt">x1 =</span> <span class="dv">0</span>, <span class="dt">x2 =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.4</span>, </span>
<span id="cb83-17"><a href="graphics.html#cb83-17"></a>        <span class="dt">arrow.head.width =</span> <span class="fl">0.6</span>, <span class="dt">arrow.head.length =</span> <span class="kw">cm_x</span>(<span class="dv">1</span>), </span>
<span id="cb83-18"><a href="graphics.html#cb83-18"></a>        <span class="dt">col =</span> col[CELL_META<span class="op">$</span>sector.numeric.index], </span>
<span id="cb83-19"><a href="graphics.html#cb83-19"></a>        <span class="dt">tail =</span> tail[CELL_META<span class="op">$</span>sector.numeric.index],</span>
<span id="cb83-20"><a href="graphics.html#cb83-20"></a>        <span class="dt">arrow.position =</span> <span class="st">&quot;start&quot;</span>)</span>
<span id="cb83-21"><a href="graphics.html#cb83-21"></a>}, <span class="dt">bg.border =</span> <span class="ot">NA</span>, <span class="dt">track.height =</span> <span class="fl">0.4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circular-arrow"></span>
<img src="03-graphics_files/figure-html/circular-arrow-1.png" alt="Circular arrows." width="768" />
<p class="caption">
Figure 3.12: Circular arrows.
</p>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="graphics.html#cb84-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
<p>Circular arrows are useful to visualize events which happen in circular style,
such as different phases in cell cycle. Following example code visualizes four
phases in cell cycle where the width of sectors correspond to the hours in
each phase (Figure <a href="graphics.html#fig:cell-cycle">3.13</a>). Also circular arrows can be used to
visualize genes in circular genome where the arrows represent the orientation
of the gene, such as <a href="https://en.wikipedia.org/wiki/Mitochondrial_DNA">mitochondrial genome</a>
or <a href="https://en.wikipedia.org/wiki/Plasmid">plasmid genome</a>. Just remember if the gene
is in the reverse strand or the negative strand, set <code>arrow.position = "start"</code> to
draw the arrow in the other direction.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="graphics.html#cb85-1"></a>cell_cycle =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">phase =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;G1&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;G2&quot;</span>, <span class="st">&quot;M&quot;</span>), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;G1&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;G2&quot;</span>, <span class="st">&quot;M&quot;</span>)),</span>
<span id="cb85-2"><a href="graphics.html#cb85-2"></a>                        <span class="dt">hour =</span> <span class="kw">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb85-3"><a href="graphics.html#cb85-3"></a>color =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#66C2A5&quot;</span>, <span class="st">&quot;#FC8D62&quot;</span>, <span class="st">&quot;#8DA0CB&quot;</span>, <span class="st">&quot;#E78AC3&quot;</span>)</span>
<span id="cb85-4"><a href="graphics.html#cb85-4"></a><span class="kw">circos.par</span>(<span class="dt">start.degree =</span> <span class="dv">90</span>)</span>
<span id="cb85-5"><a href="graphics.html#cb85-5"></a><span class="kw">circos.initialize</span>(cell_cycle<span class="op">$</span>phase, <span class="dt">xlim =</span> <span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), cell_cycle<span class="op">$</span>hour))</span>
<span id="cb85-6"><a href="graphics.html#cb85-6"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb85-7"><a href="graphics.html#cb85-7"></a>    <span class="kw">circos.arrow</span>(CELL_META<span class="op">$</span>xlim[<span class="dv">1</span>], CELL_META<span class="op">$</span>xlim[<span class="dv">2</span>], </span>
<span id="cb85-8"><a href="graphics.html#cb85-8"></a>        <span class="dt">arrow.head.width =</span> CELL_META<span class="op">$</span>yrange<span class="op">*</span><span class="fl">0.8</span>, <span class="dt">arrow.head.length =</span> <span class="kw">cm_x</span>(<span class="fl">0.5</span>),</span>
<span id="cb85-9"><a href="graphics.html#cb85-9"></a>        <span class="dt">col =</span> color[CELL_META<span class="op">$</span>sector.numeric.index])</span>
<span id="cb85-10"><a href="graphics.html#cb85-10"></a>    <span class="kw">circos.text</span>(CELL_META<span class="op">$</span>xcenter, CELL_META<span class="op">$</span>ycenter, CELL_META<span class="op">$</span>sector.index, </span>
<span id="cb85-11"><a href="graphics.html#cb85-11"></a>        <span class="dt">facing =</span> <span class="st">&quot;downward&quot;</span>)</span>
<span id="cb85-12"><a href="graphics.html#cb85-12"></a>    <span class="kw">circos.axis</span>(<span class="dt">h =</span> <span class="dv">1</span>, <span class="dt">major.at =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">round</span>(CELL_META<span class="op">$</span>xlim[<span class="dv">2</span>])), <span class="dt">minor.ticks =</span> <span class="dv">1</span>,</span>
<span id="cb85-13"><a href="graphics.html#cb85-13"></a>        <span class="dt">labels.cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb85-14"><a href="graphics.html#cb85-14"></a>}, <span class="dt">bg.border =</span> <span class="ot">NA</span>, <span class="dt">track.height =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cell-cycle"></span>
<img src="03-graphics_files/figure-html/cell-cycle-1.png" alt="Cell cycle." width="384" />
<p class="caption">
Figure 3.13: Cell cycle.
</p>
</div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="graphics.html#cb86-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
</div>
<div id="raster-image" class="section level2" number="3.10">
<h2><span class="header-section-number">3.10</span> Raster image</h2>
<p><code>circos.raster()</code> is used to add a raster image at a certain position in the
circle with proper rotation. The first input variable should be a <code>raster</code>
object or an object that can be converted by <code>as.raster()</code>. Facing of the
image is controlled by <code>facing</code> and <code>niceFacing</code> arguments which are similar
as in <code>circos.text()</code>. When value of <code>facing</code> is one of <code>inside</code>, <code>outside</code>,
<code>reverse.clockwise</code>, <code>clockwise</code> and <code>downward</code>, the size of raster image
should have absolute values which should be specified in the form of <code>number- unit</code> such as <code>"20mm"</code>, <code>"1.2cm"</code> or <code>"0.5inche"</code>. If only one of <code>width</code> and
<code>height</code> is specified, the other one is automatically calculated by using the
aspect ratio of the original image. Following example shows five types of
facings of the raster image (figure <a href="graphics.html#fig:raster-normal">3.14</a>).</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="graphics.html#cb87-1"></a><span class="kw">library</span>(png)</span>
<span id="cb87-2"><a href="graphics.html#cb87-2"></a>image =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Rlogo.png&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;circlize&quot;</span>)</span>
<span id="cb87-3"><a href="graphics.html#cb87-3"></a>image =<span class="st"> </span><span class="kw">as.raster</span>(<span class="kw">readPNG</span>(image))</span>
<span id="cb87-4"><a href="graphics.html#cb87-4"></a><span class="kw">circos.par</span>(<span class="dt">start.degree =</span> <span class="dv">90</span>)</span>
<span id="cb87-5"><a href="graphics.html#cb87-5"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb87-6"><a href="graphics.html#cb87-6"></a>all_facing_options =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;inside&quot;</span>, <span class="st">&quot;outside&quot;</span>, <span class="st">&quot;reverse.clockwise&quot;</span>, <span class="st">&quot;clockwise&quot;</span>, <span class="st">&quot;downward&quot;</span>)</span>
<span id="cb87-7"><a href="graphics.html#cb87-7"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb87-8"><a href="graphics.html#cb87-8"></a>    <span class="kw">circos.raster</span>(image, CELL_META<span class="op">$</span>xcenter, CELL_META<span class="op">$</span>ycenter, <span class="dt">width =</span> <span class="st">&quot;1cm&quot;</span>, </span>
<span id="cb87-9"><a href="graphics.html#cb87-9"></a>        <span class="dt">facing =</span> all_facing_options[CELL_META<span class="op">$</span>sector.numeric.index])</span>
<span id="cb87-10"><a href="graphics.html#cb87-10"></a>    <span class="kw">circos.text</span>(CELL_META<span class="op">$</span>xcenter, CELL_META<span class="op">$</span>ycenter, </span>
<span id="cb87-11"><a href="graphics.html#cb87-11"></a>        all_facing_options[CELL_META<span class="op">$</span>sector.numeric.index],</span>
<span id="cb87-12"><a href="graphics.html#cb87-12"></a>        <span class="dt">facing =</span> <span class="st">&quot;inside&quot;</span>, <span class="dt">niceFacing =</span> <span class="ot">TRUE</span>)</span>
<span id="cb87-13"><a href="graphics.html#cb87-13"></a>})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:raster-normal"></span>
<img src="03-graphics_files/figure-html/raster-normal-1.png" alt="Five facings of raster image." width="384" />
<p class="caption">
Figure 3.14: Five facings of raster image.
</p>
</div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="graphics.html#cb88-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
<p>Also <code>facing</code> can be set to <code>bending.inside</code> and <code>bending.outside</code> that the
image is filled to a circular rectangle. The strategy is to plot each original
pixel as a small circular rectangle by <code>circos.rect()</code>, thus, the plotting is
quite slow. If the original image is too huge, <code>scaling</code> argument can be set
to reduce the size of the original image.</p>
<p>Following code draws the image of the cover of this book which is a circular
style of <a href="https://en.wikipedia.org/wiki/Keith_Haring">Keith Haring</a>’s doodle
(Figure <a href="graphics.html#fig:raster-doodle">3.15</a>). The original source of the plot is from
<a href="http://www.thegreenhead.com/imgs/keith-haring-double-retrospect-worlds-largest-jigsaw-puzzle-2.jpg" class="uri">http://www.thegreenhead.com/imgs/keith-haring-double-retrospect-worlds-largest-jigsaw-puzzle-2.jpg</a>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="graphics.html#cb89-1"></a><span class="kw">load</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;doodle.RData&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;circlize&quot;</span>))</span>
<span id="cb89-2"><a href="graphics.html#cb89-2"></a><span class="kw">circos.par</span>(<span class="st">&quot;cell.padding&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb89-3"><a href="graphics.html#cb89-3"></a><span class="kw">circos.initialize</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb89-4"><a href="graphics.html#cb89-4"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb89-5"><a href="graphics.html#cb89-5"></a>    img =<span class="st"> </span>img_list[[CELL_META<span class="op">$</span>sector.numeric.index]]</span>
<span id="cb89-6"><a href="graphics.html#cb89-6"></a>    <span class="kw">circos.raster</span>(img, CELL_META<span class="op">$</span>xcenter, CELL_META<span class="op">$</span>ycenter, </span>
<span id="cb89-7"><a href="graphics.html#cb89-7"></a>        <span class="dt">width =</span> CELL_META<span class="op">$</span>xrange, <span class="dt">height =</span> CELL_META<span class="op">$</span>yrange, </span>
<span id="cb89-8"><a href="graphics.html#cb89-8"></a>        <span class="dt">facing =</span> <span class="st">&quot;bending.inside&quot;</span>)</span>
<span id="cb89-9"><a href="graphics.html#cb89-9"></a>}, <span class="dt">track.height =</span> <span class="fl">0.25</span>, <span class="dt">bg.border =</span> <span class="ot">NA</span>)</span>
<span id="cb89-10"><a href="graphics.html#cb89-10"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb89-11"><a href="graphics.html#cb89-11"></a>    img =<span class="st"> </span>img_list[[CELL_META<span class="op">$</span>sector.numeric.index <span class="op">+</span><span class="st"> </span><span class="dv">16</span>]]</span>
<span id="cb89-12"><a href="graphics.html#cb89-12"></a>    <span class="kw">circos.raster</span>(img, CELL_META<span class="op">$</span>xcenter, CELL_META<span class="op">$</span>ycenter, </span>
<span id="cb89-13"><a href="graphics.html#cb89-13"></a>        <span class="dt">width =</span> CELL_META<span class="op">$</span>xrange, <span class="dt">height =</span> CELL_META<span class="op">$</span>yrange, </span>
<span id="cb89-14"><a href="graphics.html#cb89-14"></a>        <span class="dt">facing =</span> <span class="st">&quot;bending.inside&quot;</span>)</span>
<span id="cb89-15"><a href="graphics.html#cb89-15"></a>}, <span class="dt">track.height =</span> <span class="fl">0.25</span>, <span class="dt">bg.border =</span> <span class="ot">NA</span>)</span>
<span id="cb89-16"><a href="graphics.html#cb89-16"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:raster-doodle"></span>
<img src="images/doodle.jpeg" alt="Fill raster image to the cell." width="400" />
<p class="caption">
Figure 3.15: Fill raster image to the cell.
</p>
</div>
</div>
<div id="links" class="section level2" number="3.11">
<h2><span class="header-section-number">3.11</span> Links</h2>
<p>Links or ribbons are important part for the circular visualization. They are
used to represent relations or interactions between sectors. In <strong>circlize</strong>,
<code>circos.link()</code> draws links between single points and intervals. There are
four mandatory arguments which are index for the first sector, positions on
the first sector, index for the second sector and positions on the second
sector. If the positions on the two sectors are all single points, the link
represents as a line. If the positions on the two sectors are intervals, the link
represents as a robbon (Figure <a href="graphics.html#fig:link-example">3.16</a>). Possible usage for
<code>circos.link()</code> is as follows.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="graphics.html#cb90-1"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>)</span>
<span id="cb90-2"><a href="graphics.html#cb90-2"></a><span class="kw">circos.link</span>(sector.index1, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), sector.index2, <span class="dv">0</span>)</span>
<span id="cb90-3"><a href="graphics.html#cb90-3"></a><span class="kw">circos.link</span>(sector.index1, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), sector.index2, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb90-4"><a href="graphics.html#cb90-4"></a><span class="kw">circos.link</span>(sector.index1, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), sector.index2, <span class="dv">0</span>, col, lwd, lty, border)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:link-example"></span>
<img src="03-graphics_files/figure-html/link-example-1.png" alt="Different types of links." width="384" />
<p class="caption">
Figure 3.16: Different types of links.
</p>
</div>
<p>The position of link end is controlled by <code>rou</code> (sorry the name should be
called <code>rho</code>, sorry for my Chinese Greek accent). By default, it is the bottom of the most inside track and
normally, you don’t need to care about this setting. The two ends of the link
are located in a same circle by default. The positions of two ends can be
adjusted with different values for <code>rou1</code> and <code>rou2</code> arguments. See Figure
<a href="graphics.html#fig:link-end">3.17</a>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="graphics.html#cb91-1"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>, rou)</span>
<span id="cb91-2"><a href="graphics.html#cb91-2"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>, rou1, rou2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:link-end"></span>
<img src="03-graphics_files/figure-html/link-end-1.png" alt="Positions of link ends." width="384" />
<p class="caption">
Figure 3.17: Positions of link ends.
</p>
</div>
<p>The height of the link is controlled by <code>h</code> argument. In most cases, you don’t
need to care about the value of <code>h</code> because they are internally calculated
based on the width of each link. However, when the link represents as a ribbon
(i.e. link from point to interval or from interval to interval), It can not
always ensure that one border is always below or above the other, which means,
in some extreme cases, the two borders are intersected and the link would be
messed up. It happens especially when position of the two ends are too close
or the width of one end is extremely large while the width of the other end is
too small. In that case, users can manually set height of the top and bottom
border by <code>h</code> and <code>h2</code> (Figure <a href="graphics.html#fig:link-height">3.18</a>).</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="graphics.html#cb92-1"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>, h)</span>
<span id="cb92-2"><a href="graphics.html#cb92-2"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>, h, h2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:link-height"></span>
<img src="03-graphics_files/figure-html/link-height-1.png" alt="Adjust link heights." width="384" />
<p class="caption">
Figure 3.18: Adjust link heights.
</p>
</div>
<p>When there are many links, the height of all links can be systematically adjusted by <code>h.ratio</code> (Figure <a href="graphics.html#fig:link-ratio">3.19</a>).
The value is between 0 and 1.</p>
<div class="figure" style="text-align: center"><span id="fig:link-ratio"></span>
<img src="03-graphics_files/figure-html/link-ratio-1.png" alt="Adjust link heights by 'h.ratio'." width="768" />
<p class="caption">
Figure 3.19: Adjust link heights by ‘h.ratio’.
</p>
</div>
<p>The border of link (if it is a ribbon) or the link itself (if it is a line) is
in fact a quadratic Bezier curve, thus you can control the shape of the link
by <code>w</code> and <code>w2</code> (<code>w2</code> controls the shape of bottom border). See Figure
<a href="graphics.html#fig:link-shape">3.20</a> for examples. For more explanation of <code>w</code>, please refer
to <a href="http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Rational_B.C3.A9zier_curves" class="uri">http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Rational_B.C3.A9zier_curves</a>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="graphics.html#cb93-1"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>, w)</span>
<span id="cb93-2"><a href="graphics.html#cb93-2"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>, w, w2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:link-shape"></span>
<img src="03-graphics_files/figure-html/link-shape-1.png" alt="Different link shapes." width="384" />
<p class="caption">
Figure 3.20: Different link shapes.
</p>
</div>
<p>When the links represent as ribbons and the two ends overlap, the links will
be de-generated as a ‘hill’ (Figure <a href="graphics.html#fig:link-hill">3.21</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:link-hill"></span>
<img src="03-graphics_files/figure-html/link-hill-1.png" alt="Link as a hill." width="384" />
<p class="caption">
Figure 3.21: Link as a hill.
</p>
</div>
<p>Links can have arrows to represent the directions. The <code>directional</code> argument
controls how to add arrows. A value of <code>0</code> means there is no direction, <code>1</code>
means the direction is from end 1 to end 2, <code>-1</code> means the direction is from
end 2 to end 1, and <code>2</code> means bi-direction. If the link represents as a
ribbon, a line with arrow will be added in the center of the link to represent
directions. See Figure <a href="graphics.html#fig:link-arrow">3.22</a>.</p>
<p>Type of arrows is controlled by <code>arr.type</code> argument and it is actually passed
to <code>Arrowhead()</code> defined in <strong>shape</strong> package. Besides the arrow types
supported in <strong>shape</strong> package, there is an additional arrow type <code>big.arrow</code>
which turns the robbon into a big arrow (Figure <a href="graphics.html#fig:link-arrow">3.22</a>).</p>
<p>Unequal height of the link ends can also represent directions which we will
discuss more with the <code>chordDiagram()</code> function.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="graphics.html#cb94-1"></a><span class="kw">circos.link</span>(sector.index1, <span class="dv">0</span>, sector.index2, <span class="dv">0</span>, <span class="dt">directional =</span> <span class="dv">1</span>)</span>
<span id="cb94-2"><a href="graphics.html#cb94-2"></a><span class="kw">circos.link</span>(sector.index1, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), sector.index2, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">directional =</span> <span class="dv">-1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:link-arrow"></span>
<img src="03-graphics_files/figure-html/link-arrow-1.png" alt="Link with arrows." width="384" />
<p class="caption">
Figure 3.22: Link with arrows.
</p>
</div>
</div>
<div id="highlight-sectors-and-tracks" class="section level2" number="3.12">
<h2><span class="header-section-number">3.12</span> Highlight sectors and tracks</h2>
<p><code>draw.sector()</code> draws sectors, rings or their parts. This function is useful
if you want to highlight some parts of your circular plot. it needs arguments
of the position of circle center (by default <code>c(0, 0)</code>), the start degree and
the end degree for sectors, and radius for two edges (or one edge) which are
up or bottom borders. <code>draw.sector()</code> is independent from the circular plot.</p>
<p>Possible usage of <code>draw.sector()</code> is as follows.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="graphics.html#cb95-1"></a><span class="kw">draw.sector</span>(start.degree, end.degree, rou1)</span>
<span id="cb95-2"><a href="graphics.html#cb95-2"></a><span class="kw">draw.sector</span>(start.degree, end.degree, rou1, rou2, center)</span>
<span id="cb95-3"><a href="graphics.html#cb95-3"></a><span class="kw">draw.sector</span>(start.degree, end.degree, rou1, rou2, center, col, border, lwd, lty)</span></code></pre></div>
<p>Directions from <code>start.degree</code> and <code>end.degree</code> is important for drawing sectors.
By default, it is clock wise.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="graphics.html#cb96-1"></a><span class="kw">draw.sector</span>(start.degree, end.degree, <span class="dt">clock.wise =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Following code shows examples of <code>draw.sector()</code> (Figure <a href="graphics.html#fig:draw-sector-general">3.23</a>).</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="graphics.html#cb97-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb97-2"><a href="graphics.html#cb97-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">asp =</span> <span class="dv">1</span>)</span>
<span id="cb97-3"><a href="graphics.html#cb97-3"></a><span class="kw">draw.sector</span>(<span class="dv">20</span>, <span class="dv">0</span>)</span>
<span id="cb97-4"><a href="graphics.html#cb97-4"></a><span class="kw">draw.sector</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="dt">rou1 =</span> <span class="fl">0.8</span>, <span class="dt">rou2 =</span> <span class="fl">0.5</span>, <span class="dt">clock.wise =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="st">&quot;#FF000080&quot;</span>)</span>
<span id="cb97-5"><a href="graphics.html#cb97-5"></a><span class="kw">draw.sector</span>(<span class="dv">350</span>, <span class="dv">1000</span>, <span class="dt">col =</span> <span class="st">&quot;#00FF0080&quot;</span>, <span class="dt">border =</span> <span class="ot">NA</span>)</span>
<span id="cb97-6"><a href="graphics.html#cb97-6"></a><span class="kw">draw.sector</span>(<span class="dv">0</span>, <span class="dv">180</span>, <span class="dt">rou1 =</span> <span class="fl">0.25</span>, <span class="dt">center =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">border =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb97-7"><a href="graphics.html#cb97-7"></a><span class="kw">draw.sector</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dt">rou1 =</span> <span class="fl">0.7</span>, <span class="dt">rou2 =</span> <span class="fl">0.6</span>, <span class="dt">col =</span> <span class="st">&quot;#0000FF80&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:draw-sector-general"></span>
<img src="03-graphics_files/figure-html/draw-sector-general-1.png" alt="General usage of 'draw.sector()'." width="384" />
<p class="caption">
Figure 3.23: General usage of ‘draw.sector()’.
</p>
</div>
<p>In order to highlight cells in the circular plot, we can use
<code>get.cell.meta.data()</code> to get the information of positions of cells. E.g. the
start degree and end degree can be obtained through <code>cell.start.degree</code> and
<code>cell.end.degree</code>, and the position of the top border and bottom border can be
obtained through <code>cell.top.radius</code> and <code>cell.bottom.radius</code>. Following code
shows several examples to highlight sectors and tracks.</p>
<p>First we create a circular plot with eight sectors and three tracks.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="graphics.html#cb98-1"></a>sectors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</span>
<span id="cb98-2"><a href="graphics.html#cb98-2"></a><span class="kw">circos.initialize</span>(sectors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb98-3"><a href="graphics.html#cb98-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb98-4"><a href="graphics.html#cb98-4"></a>    <span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb98-5"><a href="graphics.html#cb98-5"></a>}</span>
<span id="cb98-6"><a href="graphics.html#cb98-6"></a><span class="kw">circos.info</span>(<span class="dt">plot =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>If we want to highlight sector a (Figure <a href="graphics.html#fig:circlize-highlight">3.24</a>):</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="graphics.html#cb99-1"></a><span class="kw">draw.sector</span>(<span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.start.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>),</span>
<span id="cb99-2"><a href="graphics.html#cb99-2"></a>            <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.end.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>),</span>
<span id="cb99-3"><a href="graphics.html#cb99-3"></a>            <span class="dt">rou1 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.top.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>), </span>
<span id="cb99-4"><a href="graphics.html#cb99-4"></a>            <span class="dt">col =</span> <span class="st">&quot;#FF000040&quot;</span>)</span></code></pre></div>
<p>If we want to highlight track 1 (Figure <a href="graphics.html#fig:circlize-highlight">3.24</a>):</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="graphics.html#cb100-1"></a><span class="kw">draw.sector</span>(<span class="dv">0</span>, <span class="dv">360</span>, </span>
<span id="cb100-2"><a href="graphics.html#cb100-2"></a>    <span class="dt">rou1 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.top.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>),</span>
<span id="cb100-3"><a href="graphics.html#cb100-3"></a>    <span class="dt">rou2 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.bottom.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>),</span>
<span id="cb100-4"><a href="graphics.html#cb100-4"></a>    <span class="dt">col =</span> <span class="st">&quot;#00FF0040&quot;</span>)           </span></code></pre></div>
<p>If we want to highlight track 2 and 3 in sector e and f (Figure <a href="graphics.html#fig:circlize-highlight">3.24</a>):</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="graphics.html#cb101-1"></a><span class="kw">draw.sector</span>(<span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.start.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;e&quot;</span>),</span>
<span id="cb101-2"><a href="graphics.html#cb101-2"></a>            <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.end.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;f&quot;</span>),</span>
<span id="cb101-3"><a href="graphics.html#cb101-3"></a>            <span class="dt">rou1 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.top.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">2</span>),</span>
<span id="cb101-4"><a href="graphics.html#cb101-4"></a>            <span class="dt">rou2 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.bottom.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">3</span>),</span>
<span id="cb101-5"><a href="graphics.html#cb101-5"></a>            <span class="dt">col =</span> <span class="st">&quot;#0000FF40&quot;</span>)</span></code></pre></div>
<p>If we want to highlight specific regions such as a small region inside cell
<code>h:2</code>, we can use <code>circlize()</code> to calculate the positions in the polar
coordinate. But always keep in mind that x-axis in the cell are always clock
wise. See Figure <a href="graphics.html#fig:circlize-highlight">3.24</a>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="graphics.html#cb102-1"></a>pos =<span class="st"> </span><span class="kw">circlize</span>(<span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>), <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>), <span class="dt">sector.index =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">track.index =</span> <span class="dv">2</span>)</span>
<span id="cb102-2"><a href="graphics.html#cb102-2"></a><span class="kw">draw.sector</span>(pos[<span class="dv">1</span>, <span class="st">&quot;theta&quot;</span>], pos[<span class="dv">2</span>, <span class="st">&quot;theta&quot;</span>], pos[<span class="dv">1</span>, <span class="st">&quot;rou&quot;</span>], pos[<span class="dv">2</span>, <span class="st">&quot;rou&quot;</span>], </span>
<span id="cb102-3"><a href="graphics.html#cb102-3"></a>    <span class="dt">clock.wise =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;#00FFFF40&quot;</span>)</span>
<span id="cb102-4"><a href="graphics.html#cb102-4"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-highlight"></span>
<img src="03-graphics_files/figure-html/circlize-highlight-1.png" alt="Highlight sectors and tracks." width="384" />
<p class="caption">
Figure 3.24: Highlight sectors and tracks.
</p>
</div>
<p>If the purpose is to simply highlight complete cells, there is a helper
function <code>highlight.sector()</code> for which you only need to specify index for
sectors and tracks that you want to to highlight. Paddings of the highligted
regions can be set by <code>padding</code> argument which should contain four values
representing ratios of the width or height of the highlighted region (Figure <a href="graphics.html#fig:circlize-highlight-sector">3.25</a>).</p>
<p>One advantage of <code>highlight.sector()</code> is that it supports to add text in the
highlighted regions. By default, the text is drawn at that center of the
highlighted region. The position on the radical direction can be set by
<code>text.vjust</code> argument either by a numeric value or a string in form of <code>"2 inches"</code> or <code>"-1.2cm"</code>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="graphics.html#cb103-1"></a>sectors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</span>
<span id="cb103-2"><a href="graphics.html#cb103-2"></a><span class="kw">circos.initialize</span>(sectors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb103-3"><a href="graphics.html#cb103-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb103-4"><a href="graphics.html#cb103-4"></a>    <span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb103-5"><a href="graphics.html#cb103-5"></a>}</span>
<span id="cb103-6"><a href="graphics.html#cb103-6"></a><span class="kw">circos.info</span>(<span class="dt">plot =</span> <span class="ot">TRUE</span>)</span>
<span id="cb103-7"><a href="graphics.html#cb103-7"></a></span>
<span id="cb103-8"><a href="graphics.html#cb103-8"></a><span class="kw">highlight.sector</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;h&quot;</span>), <span class="dt">track.index =</span> <span class="dv">1</span>, <span class="dt">text =</span> <span class="st">&quot;a and h belong to a same group&quot;</span>,</span>
<span id="cb103-9"><a href="graphics.html#cb103-9"></a>    <span class="dt">facing =</span> <span class="st">&quot;bending.inside&quot;</span>, <span class="dt">niceFacing =</span> <span class="ot">TRUE</span>, <span class="dt">text.vjust =</span> <span class="st">&quot;6mm&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb103-10"><a href="graphics.html#cb103-10"></a><span class="kw">highlight.sector</span>(<span class="st">&quot;c&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;#00FF0040&quot;</span>)</span>
<span id="cb103-11"><a href="graphics.html#cb103-11"></a><span class="kw">highlight.sector</span>(<span class="st">&quot;d&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb103-12"><a href="graphics.html#cb103-12"></a><span class="kw">highlight.sector</span>(<span class="st">&quot;e&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;#0000FF40&quot;</span>, <span class="dt">track.index =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb103-13"><a href="graphics.html#cb103-13"></a><span class="kw">highlight.sector</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;g&quot;</span>), <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="st">&quot;green&quot;</span>, </span>
<span id="cb103-14"><a href="graphics.html#cb103-14"></a>    <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">track.index =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">padding =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))</span>
<span id="cb103-15"><a href="graphics.html#cb103-15"></a><span class="kw">highlight.sector</span>(sectors, <span class="dt">col =</span> <span class="st">&quot;#FFFF0040&quot;</span>, <span class="dt">track.index =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-highlight-sector"></span>
<img src="03-graphics_files/figure-html/circlize-highlight-sector-1.png" alt="Highlight sectors." width="384" />
<p class="caption">
Figure 3.25: Highlight sectors.
</p>
</div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="graphics.html#cb104-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>
</div>
<div id="work-with-base-graphic-system" class="section level2" number="3.13">
<h2><span class="header-section-number">3.13</span> Work together with the base graphic system</h2>
<p><strong>circlize</strong> is built on the base R graphic system, then, of course the base graphic
functions can be used in combination with circlize functions. On the other hand,
<code>circlize()</code> converts data points from the data coordinates to the canvas coordinates
where the base graphic function can be directly applied.</p>
<p>Normally, the base functions such as <code>title()</code>, <code>text()</code>, <code>legend()</code> can be used to
add extra information on the plot (Figure <a href="graphics.html#fig:circlize-base">3.26</a>).</p>
<p>Sometimes, when the text or other graphics are far from the circle, you may set <code>par(xpd = NA)</code>
so that the plotting is not clipped.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="graphics.html#cb105-1"></a>sectors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb105-2"><a href="graphics.html#cb105-2"></a><span class="kw">circos.initialize</span>(sectors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb105-3"><a href="graphics.html#cb105-3"></a><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb105-4"><a href="graphics.html#cb105-4"></a>    <span class="kw">circos.points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span><span class="op">/</span><span class="dv">20</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span><span class="op">/</span><span class="dv">20</span>)</span>
<span id="cb105-5"><a href="graphics.html#cb105-5"></a>})</span>
<span id="cb105-6"><a href="graphics.html#cb105-6"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="st">&quot;This is</span><span class="ch">\n</span><span class="st">the center&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb105-7"><a href="graphics.html#cb105-7"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">legend =</span> <span class="st">&quot;This is the legend&quot;</span>)</span>
<span id="cb105-8"><a href="graphics.html#cb105-8"></a><span class="kw">title</span>(<span class="st">&quot;This is the title&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circlize-base"></span>
<img src="03-graphics_files/figure-html/circlize-base-1.png" alt="Work with base graphic functions." width="672" />
<p class="caption">
Figure 3.26: Work with base graphic functions.
</p>
</div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="graphics.html#cb106-1"></a><span class="kw">circos.clear</span>()</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="circular-layout.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="legends.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/circlize_book/edit/master/03-graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
